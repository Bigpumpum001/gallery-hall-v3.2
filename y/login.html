<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery Hall Online</title>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <!-- <link rel="stylesheet" href="css/style.css"> -->
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background-image: url('bgindex.jfif');
            /* เปลี่ยนเป็น path ของรูปภาพที่คุณต้องการใช้ */
            background-size: cover;
            /* ปรับขนาดภาพให้ครอบคลุมพื้นที่ทั้งหมด */
            background-position: center;
            /* จัดตำแหน่งภาพให้อยู่ตรงกลาง */
            background-repeat: no-repeat;
            /* ไม่ให้ภาพซ้ำ */



        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            background: #ffffff;
            border-radius: 10px;
            padding: 0 0rem 0 0;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;

        }

        /* .image-section .form-section{
    padding:10rem;
    font-size: 108px;
} */
        .image-section {
            background: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            /* padding: 3rem 0 0 0; */
            /* padding: 120px 40px; */

        }

        .image-section img {
            max-width: 50%;
            border-radius: 5px;
            /* width="300" height="250" */
        }

        .form-section {
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;


        }

        .form-section h2 {
            margin-bottom: 0px;
            font-size: 20px;
            color: #333333;
            font-family: 'Arimo';
            /* line-height: 80.49px; */
        }

        .form-section p {
            color: #8C8C8C;
            font-size: 15px;
            font-family: 'Arimo';
            font-weight: 400;

        }

        /* .form-section input {
    margin-bottom: 10px;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-size: 16px;
} */
        .input-container {
            display: flex;
            align-items: center;


            padding: 5px;
            position: relative;

        }

        .input-container input {
            padding-left: 30px;
            height: 35px;
            border-radius: 5px;
            border: 1px solid #ccc;
            outline: none;

        }

        .input-container i {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: black;
            /* สีไอคอน Facebook */
            font-size: 30px;
            margin-left: -4px;
        }
        .input-container #togglePassword{
            position: absolute;
            color: #888; /* สีเทา */
            left: 235px;
            top: 50%;
            transform: translateY(-50%);
    
            /* สีไอคอน Facebook */
            font-size: 30px;
            margin-left: -4px;
        }

        .form-section button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }

        .signin-signup {
            padding-top: 0.6rem;
            display: flex;
            gap: 0.6rem;



        }

        .form-section .signin-button {
            background-color: #7ee18e;
            color: black;
            margin-bottom: 10px;
            font-family: 'Arimo';
            font-weight: 600;
            width: 100%;
            border-radius: 3rem;
            font-size: 16px;
            height: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;

        }

        .form-section .signup-button {
            background-color: #8aaee1;
            color: black;
            margin-bottom: 10px;
            font-family: 'Arimo';
            font-weight: 600;
            width: 100%;
            border-radius: 3rem;
            font-size: 16px;
            height: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
    
        .signin-button:hover {
            background-color: #32cd32;
            /* สีเขียวเข้มขึ้นเมื่อเมาส์อยู่บนปุ่ม */
        }
        .signup-button:hover {
            background-color: #4682b4;
            /* สีเขียวเข้มขึ้นเมื่อเมาส์อยู่บนปุ่ม */
        }
        .hr-with-text {
            display: flex;
            align-items: center;
            text-align: center;
            width: 100%;
            padding-bottom: 1rem;

        }


        .hr-with-text::before,
        .hr-with-text::after {
            content: "";
            flex: 1;
            border-bottom: 1px solid #ccc;
        }

        .hr-with-text::before {
            margin-right: 10px;
        }

        .hr-with-text::after {
            margin-left: 10px;
        }

        .hr-with-text span {
            padding: 0 10px;
            /* ระยะห่างระหว่างข้อความกับเส้น */
            font-family: 'Arimo';
            font-weight: 400;
            font-size: 16px;
            color: #333;
            /* สีข้อความ */
        }

        .form-section .google-button {

            background-color: #ffffff;
            color: #F97C7C;
            border: 1px solid #F97C7C;
            width: 100%;
            border-radius: 0.5rem;
            font-weight: 500;
            font-family: 'Arimo';
            font-size: 20px;
        }

        .form-section .google-button:hover {
            background-color: #dd4b39;
            color: white;

        }

        .form-section form input {
            font-family: 'Poppins', sans-serif;
            font-size: 15px;
            width: 150%;


        }

        @media (max-width:991px) {
            .image-section img {
                /* width: 150%; */
                max-width: 15rem;
                width: auto;
                margin-top: 1rem;
            }

            .container {
                display: block;
            }

        }

        .messageDiv {
            background-color: pink;
            color: white;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 6px;
            font-size: 1rem;
            opacity: 0;
            animation: fadeOut 7s forwards;

        }

        .hr-message-hr {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hr-message-hr hr{
            width: 30%;
        }
        .line{
            flex: 1;
            border: none;
            height: 1px;
            background-color: #d5d5d5;
            margin: 0;
        }
        .new-user{
            margin: 0 10px;
        }
        .a-reg{
            display: flex;
            justify-content: center;
         
        }
        .a-reg a{
            margin-top: 10px;
            font-family: 'Poppins', sans-serif;;
        }
        /* .togglePassword{
            right: 10%;
        } */
       
    </style>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import Firebase functions in modular style
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, collection, query, where, getDocs, getDoc, doc } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBHqagE_76AF0f8bRg-9Mx_QF0GtEaTya8",
            authDomain: "gho-project.firebaseapp.com",
            projectId: "gho-project",
            storageBucket: "gho-project.firebasestorage.app",
            messagingSenderId: "217715167340",
            appId: "1:217715167340:web:c68f10020c6c33d476c849"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Updated date formatting function to ensure English output
        function formatDate(timestamp) {
            if (!timestamp) return "Not specified";
            
            // Convert Firestore timestamp to Date object
            const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
            
            // Format date specifically for English
            const months = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            
            const day = date.getDate();
            const month = months[date.getMonth()];
            const year = date.getFullYear();
            
            return `${month} ${day}, ${year}`;
        }

        // Rest of the functions remain the same
        async function checkBanStatus(email) {
            const bannedRef = collection(db, "banned");
            const q = query(bannedRef, where("email", "==", email));
            const querySnapshot = await getDocs(q);
            
            if (!querySnapshot.empty) {
                const banData = querySnapshot.docs[0].data();
                return {
                    isBanned: true,
                    banEndDate: banData.banEndDate,
                    banReason: banData.banReason,
                    email: banData.email
                };
            }
            return { isBanned: false };
        }

        async function validateLogin(email, password) {

            // ADMIN LIST // ADMIN LIST // ADMIN LIST // ADMIN LIST 
            // ADMIN LIST // ADMIN LIST // ADMIN LIST // ADMIN LIST 
            // ADMIN LIST // ADMIN LIST // ADMIN LIST // ADMIN LIST 
            const adminEmails = ["admin@admin.com","admin2@admin.com","admin3@admin.com"];
            // ADMIN LIST // ADMIN LIST // ADMIN LIST // ADMIN LIST 
            // ADMIN LIST // ADMIN LIST // ADMIN LIST // ADMIN LIST 
            // ADMIN LIST // ADMIN LIST // ADMIN LIST // ADMIN LIST
            try {
                // Check ban status first
                const banStatus = await checkBanStatus(email);
                if (banStatus.isBanned) {
                    const formattedEndDate = formatDate(banStatus.banEndDate);
                    const message = `Account Suspended\n\nEmail: ${banStatus.email}\nReason: ${banStatus.banReason}\nUnban Date: ${formattedEndDate}\n\nPlease contact administrator for assistance.`;
                    alert(message);
                    return;
                }

                // Rest of the login logic remains the same
                const q = query(collection(db, "User"), 
                    where("email", "==", email), 
                    where("password", "==", password)
                );

                const querySnapshot = await getDocs(q);
                if (!querySnapshot.empty) {
                    localStorage.setItem("isLoggedIn", true);
                    localStorage.setItem("loggedInEmail", email);

                    const adminEmails = ["admin@admin.com", "admin2@admin.com", "admin3@admin.com"];
                    if (adminEmails.includes(email)) {
                        alert("Admin login successful!");
                        window.location.href = "home2.html";
                    } else {
                        alert("Login successful!");
                        window.location.href = "profile.html";
                    }
                } else {
                    alert("Invalid email or password. Please try again.");
                }
            } catch (error) {
                console.error("Error during login: ", error);
                alert("An error occurred. Please try again.");
            }
        }

        // Event listeners เหมือนเดิม
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("login-form").addEventListener("submit", async (e) => {
                e.preventDefault();
                const email = document.getElementById("email").value;
                const password = document.getElementById("password").value;
                await validateLogin(email, password);
            });

            const togglePassword = document.getElementById('togglePassword');
            const password = document.getElementById('password');

            togglePassword.addEventListener('click', function () {
                const isPassword = password.getAttribute('type') === 'password';
                password.setAttribute('type', isPassword ? 'text' : 'password');
                this.classList.toggle('bx-show');
                this.classList.toggle('bx-hide');
            });
        });
    </script>
</head>

<body>
    <div class="container">
        <div class="image-section">
            <img src="sign-in-removebg-preview.png" alt="Painter Image">
        </div>
        <div class="form-section">
            <h2>Welcome to Gallery Hall Online</h2>
            <p>Sign in to Continue</p>
            <form id="login-form">
                <div class="input-container">
                    <i class='bx bxs-user-account'></i>
                    <input type="text" id="email" placeholder="Email" required><br>
                    
                </div>
                <div class="input-container">
                    <i class='bx bx-lock-alt'></i>
                    <input type="password" id="password" placeholder="Password" required><br>
                    <i class="bx bx-show" id="togglePassword"></i>
                </div>
                <div class="signin-signup">
                    <button class="signin-button" type="submit">Login</button>
                    <!-- <button class="signup-button" type="button" onclick="window.location.href='register.html'">Sign
                        Up</button> -->
                </div>
                <div class="hr-message-hr">
                    <hr class="line">
                    <p class="new-user">New User?</p>
                    <hr class="line">


                </div>
                <div class="signin-signup">
                   
                    <button class="signup-button" type="button" onclick="window.location.href='register.html'">
                        Register</button>
                </div>
                <!-- <div class="a-reg">
                    <a href="register.html">Sign up</a>
                </div> -->
                
            </form>
        </div>
    </div>
</body>

</html>